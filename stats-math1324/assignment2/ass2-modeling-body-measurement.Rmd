---
title: "MATH1324 Introduction to Statistics Assignment 2"
author: "Phil Steinke s3725547"
output: html_notebook
---

# Modelling Body Measurements
This assignment is worth 5%
by 29/04/2018.

# Body Measurements Dataset Description

#### Overview
The goal of this assignment is simple. You must determine if one of the body measurements fits a normal distribution. To do this, you are going to use the “Body” Dataset (bdims.csv) which is located under Google Drive -> Data Repository.

## 1. Problem Statement  [Plain text]:
_Write a clear and concise problem statement that guides your investigation. Explain which variable you choose and outline the approaches taken for normal distribution fitting._

## Statement goes here:

#### Instructions:
You are required to select **ONLY ONE MEASUREMENT** from the dataset for this investigation. You must decide which measurement to deal with. You don’t need to include all variables.

Since males and females tend to have different body dimensions, you are required to investigate the normality assumption of the selected variable separately in men and women.

Let’s say that you selected biacromial diameter measurement as a variable of interest. Then you should investigate if this measurement fits a normal distribution in men and in women separately.

Keep in mind that there will be some cases in which men’s distribution may fit a normal distribution where else female's distribution may not fit a normal distribution, or vice a versa.

##  2. Load Packages:
- This section is not marked.
Data [R Chunk]: Import the body measurements data and prepare it for analysis. Show your code.
```{r}
suppressPackageStartupMessages(library(readr))
suppressPackageStartupMessages(library(base))
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(readxl))
suppressPackageStartupMessages(library("mosaic", lib.loc="/Library/Frameworks/R.framework/Versions/3.4/Resources/library"))
setwd("~/code/tldr/data-science/stats-math1324/assignment2")
suppressPackageStartupMessages(library("gridExtra"))
suppressPackageStartupMessages(library("latticeExtra"))

```

## 3. Data [R Chunk]: Import the body measurements data and prepare it for analysis. Show your code.

```{r}
body_measurements <- read_excel("data/bdims.csv (1).xlsx",
    sheet = "bdims.csv") %>%
  as.data.frame()
head(body_measurements)
```


## Select your measurement here
```{r}
head(body_measurements)
```

#### Instructions: Tidy it up
- tidy it up (e.g., you may need to define the variable sex as a factor and define labels for it) using R functions.
- (e.g. you may need to define the variable sex as a factor and define labels for it) using R functions.

```{r}
wrist_measurements <- select(body_measurements, wri.gi, sex) %>%
  as.data.frame()
colnames(x = wrist_measurements) <- c("wrist.girth", "sex")
wrist_measurements
```

## 4. Summary Statistics [R Chunk]:

#### Instructions
- Calculate descriptive statistics (i.e., mean, median, standard deviation, first and third quartile, interquartile range, minimum and maximum values) of the selected measurement grouped by sex.

## Summary of wrist measurements
```{r}
wrist_summary <- wrist_measurements$wrist.girth

cat("summary \n")
summary(wrist_summary)

cat("summary mean \n")
summary_mean <-
  mean(wrist_summary) %>%
  print()

cat("standard deviation \n")
summary_sd <-
  sd(wrist_summary) %>%
  print()

cat("Interquartile Range \n")
IQR(wrist_summary)

```

## Male
```{r}
male <- subset(
  wrist_measurements,
  sex == 1    
  )$wrist.girth

cat("summary \n")
summary(male)

male_mean <-
  mean(male) %>%
  print()

cat("standard deviation \n")
male_sd <-
  sd(male) %>%
  print()

cat("Interquartile Range \n")
IQR(male)

```

## Female
```{r}
female <- subset(
  wrist_measurements,
  sex == 0  
  )$wrist.girth

cat("summary \n")
summary(female)

female_mean <-
  mean(female) %>%
  print()

cat("standard deviation \n")
female_sd <-
  sd(female) %>%
  print()

cat("Interquartile Range \n")
IQR(female)

```



## 5. Distribution Fitting [Plain Text and R Chunk] :

Instructions: Compare the empirical distribution of selected body measurement to a normal distribution separately in men and in women. You need to do this visually by plotting the histogram with normal distribution overlay. Show your code.

```{r}
# histogram_and_plot_dist <-
#   function(this_mean, this_sd) {
    
    histogram(
      x = wrist_summary,
      type="density",
      main = "Wrist girth and normal distribution",
      col=rgb(0,0,0,alpha=0.0),
      xlim=c(12,21),
      ylim = c(0,0.50),
      breaks = 40
      )

    plotDist(
      "norm",
      mean = summary_mean,
      sd = summary_sd,
      kind= "density",
      type = "b",
      col = "red",
      lwd=2,
      add=TRUE) %>%
      return()
  # }

# histogram_and_plot_dist(summary_mean, summary_sd, message)

?histogram
        
```

- Then you will use R to summarise the empirical distribution of body measurement separately in men and women and compare it to a normal distribution. You need to do this visually by plotting the histogram with normal distribution overlay.

## summarise the empirical distribution of body measurement


## compare it to a normal distribution
- by plotting the histogram with normal distribution overlay


### for men
```{r}

farp <- function(x, male_mean) {
        panel.mathdensity(
          # dmath = dnorm,
          args = list(mean=male_mean,sd=male_sd)
        )
    }

    histogram(
      x = male,
      type="density",
      main = "male wrist girth against normal distribution",
      col=rgb(0,0,0,alpha=0.0), xlim=c(12,21), ylim = c(0,0.50),
      breaks = 40,
      xlab = "Height (inches)",
      ylab = "Density Histogram\n with Normal Fit",
      panel = farp
      ) -> male_histogram

    plotDist(
      "norm",
      mean = summary_mean,
      sd = summary_sd,
      kind= "density",
      type = "b",
      col = "blue",
      lwd=2,
      add=TRUE) -> male_histogram
    
    #   # abline(lm(duration ~ waiting, data=faithful))
    # 
    #   
    # 
    # male_histogram <-
    # 

    male_histogram

```

### for females
```{r}
    histogram(
      x = female,
      type="density",
      main = "female wrist girth against normal distribution",
      col=rgb(0,0,0,alpha=0.0), xlim=c(12,21), ylim = c(0,0.50),
      breaks = 40
      )

    plotDist(
      "norm",  
      mean = summary_mean,
      sd = summary_sd,
      kind= "density",
      type = "b",
      col = "red",
      lwd=2,
      add=TRUE) %>%
      return()

```

## Interpretation [Plain text]:

### What insight has been gained from the investigation?

- dot point 1
- dot point 2
- dot point 3

### Discuss the extent to how your theoretical normal distribution fits the empirical data

- dot point 1
- dot point 2
- dot point 3

### Make recommendations regarding the modelling of this body measurement

- dot point 1
- dot point 2
- dot point 3
